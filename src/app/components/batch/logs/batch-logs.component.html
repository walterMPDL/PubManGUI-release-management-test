<div class="batch">
  <div class="logs">
    <div class="row top_nav_pos navbar bg-body" [ngClass]="{ 'scrolled': isScrolled }">
      <div class="col-lg-12 col-sm-12 d-inline-flex justify-content-end">

        <div class="small d-inline-flex align-items-center">
          <pure-paginator [totalNumberOfItems]="collectionSize" [(pageNumber)]="currentPage" [(size)]="pageSize" (paginatorChanged)="refreshLogs()" />
        </div>
      </div>
    </div>

    <div class="row">
      <div class="my-3"></div>
    </div>

    <div class="row">
      <div class="col-lg-12 col-sm-12">
        <table class="table table-responsive col-12 mt-1">
          <thead>
            <tr class="border-bottom">
              <th scope="col" class="pe-2">Status</th>
              <th scope="col" class="pe-2" i18n="@@batch.logs.details.for">Action</th>
              <th scope="col" class="pe-2" i18n="@@batch.logs.header.date">Date</th>
              <th scope="col" i18n="@@batch.logs.header.details">Details</th>
            </tr>
          </thead>

          <tbody>
            @for (log of inPage; track log.batchLogHeaderId) {
            <tr class="border-bottom">
              @if (log.state === state.RUNNING) {
              <td class="col-2">
                {{ batchSvc.getProcessLog().state | titlecase }}
                @if (log.batchLogHeaderId === batchSvc.getProcessLog().batchLogHeaderId) {
                @if (batchSvc.isProcessRunning()) {
                {{batchSvc.getProcessLog().percentageOfProcessedItems -
                calculateProcessedStep(batchSvc.getProcessLog().numberOfItems) }}&percnt;
                }
                } @else {
                <span class="material-symbols-outlined" title="Something gone wrong!">
                  error
                </span>
                }
              </td>
              } @else {
              <td class="col-2">
                {{ getProcessLogHeaderStateTranslation(log.state) }}
              </td>
              }
              <td class="col-5">
                {{ getProcessMethodTranslation(log.method) }}
              </td>
              <td class="col-4">
                <span>{{ log.endDate | date:'fullDate' }}</span>
                <div class="float-end">
                  <span class="material-symbols-outlined" style="cursor: auto">schedule</span>&nbsp;
                  <span>{{ log.endDate | date: "HH:mm" }}</span>
                </div>
              </td>
              <td class="col-1">
                @if (log.state === state.RUNNING
                && log.batchLogHeaderId === batchSvc.getProcessLog().batchLogHeaderId
                && batchSvc.isProcessRunning()) {
                <span class="spinner-border ms-3" aria-hidden="true"></span>
                } @else {
                <a [routerLink]="['/batch/logs/', log.batchLogHeaderId]"
                  [state]="{ batchLogHeader: log }">
                    <span class="material-symbols-outlined ms-3 my-0 matBadge" matBadge='{{ log.numberOfItems }}'>
                      list
                    </span>
                </a>
                }
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>

      <!--div class="col-lg-2 d-none d-lg-block">

      </div-->
    </div>
  </div>
</div>
